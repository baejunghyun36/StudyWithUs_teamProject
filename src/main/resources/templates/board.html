<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>자유게시판 목록</title>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <script>
        jQuery(document).ready(function (){
            // writerCheck();

            $("#writerCheck").click(function () {
                writerCheck();
                console.log("글쓰기 클릭");
            })


            function writerCheck() {
                $.ajax({
                    url: "/checkUser",
                    type: "POST",
                    success: function (data) {
                        console.log('성공')
                        console.log(data)
                        if (data == 0) {
                            alert("게시글은 회원만 작성할 수 있습니다.")
                        } else {
                            location.href = '/write';
                        }
                    }, error: function (error) {
                        console.log(error);
                    }
                });
            }

        });
    </script>
</head>
<body>

<div class="container" style="margin-top: 10px;">
    <div class="row">
        <div class="col-xs-3">
            <a th:href="@{/}">로고</a>
        </div>
        <div class="col-xs-4"></div>
        <div class="col-xs-1"><a th:href="@{/boardSearch}">자유게시판</a></div>
        <div class="col-xs-1"><a th:href="@{login}">로그인</a></div>
        <div class="col-xs-2">
            <button type="submit" onclick="location.href='/myPage'">
                마이페이지
            </button>
        </div>
    </div>
</div>

<div class="row" style="margin-top: 20px; margin-left: 50px;">
    <div class="col-xs-4">
        <h2>자유게시판</h2>
    </div>
</div>

<form class="row mb-3" th:action="@{/boardSearch}">
    <div class="col-sm-11">
        <input class="form-control form-control-lg" type="text" name="keyword" th:value="${param.keyword}" placeholder="게시글을 검색하세요"/>
    </div>
    <div class="col-sm-1">
        <button id="searchbtn" type="submit" class="btn btn-success"><i class="bi bi-search" style="font-size: 1.5em; "></i></button>
    </div>
</form>
<table class="table table-striped table-hover" style="text-align: center">
    <thead class="table-dark">
        <th style="width: 6em;">No.</th>
        <th>제목</th>
        <th style="width: 15em">작성자</th>
        <th style="width: 15em">작성일</th>
    </thead>
    <tbody>
    <sc
    <tr th:each="list,idx : ${VOlist}" id="dataTable">
        <th th:text="${list.idx}"></th>
        <td th:text="${list.title}"></td>
        <td th:text="${list.name}"></td>
        <td th:text="${list.uploadTime}"></td>
    </tr>
    <tr th:if="${boardList.content.size()==0}">
        <td colspan="4" style="text-align: center">게시물이 존재하지 않습니다.</td>
    </tr>
    </tbody>
</table>

<div th:if="${VOlist.size()!=0}">
    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-center">
            <li class="page-item" th:classappend="${1 ==currentPage} ? 'disabled'" >
                <a class="page-link" href="#" th:href="@{/boardSearch(page=0,keyword=${param.keyword})}" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li class="page-item" th:classappend="${1 ==currentPage} ? 'disabled'" >
                <a class="page-link" href="#" th:href="@{/boardSearch(page=${currentPage-2},keyword=${param.keyword})}" aria-label="Previous">
                    <span aria-hidden="true"><</span>
                </a>
            </li>
            <li class="page-item" th:classappend="${idx ==currentPage} ? 'disabled'" th:each="idx:${#numbers.sequence(startPage,endPage)}">
                <a class="page-link" href="#" th:href="@{/boardSearch(page=${idx-1},keyword=${param.keyword})}" th:text="${idx}"></a></li>

            <li class="page-item" th:classappend="${boardList.totalPages ==currentPage} ? 'disabled'">
                <a class="page-link" href="#" th:href="@{/boardSearch(page=${currentPage},keyword=${param.keyword})}"  aria-label="Next">
                    <span aria-hidden="true">></span>
                </a>
            </li>
            <li class="page-item" th:classappend="${boardList.totalPages ==currentPage} ? 'disabled'">
                <a class="page-link" href="#" th:href="@{/boardSearch(page=${end-1},keyword=${param.keyword})}"  aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>

<div class="col-xs-2" style="float: right; margin-top: 30px;">
    <button type="button" id="writerCheck">
        글작성
    </button>
</div>
</body>
</html>